(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-common"],{"034f":function(e,t,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"1f6e":function(e,t,n){},3778:function(e,t,n){"use strict";var a=n("ba79"),s=n.n(a);s.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d"),n("bf40");var a=n("2ead"),s=n.n(a),i=n("ce5b"),r=n.n(i),o=(n("0284"),n("2b0e")),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("v-app",{attrs:{dark:""}},[n("v-navigation-drawer",{attrs:{fixed:"",clipped:"",app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("v-list",{attrs:{dense:""}},[n("v-list-tile",{on:{click:function(t){e.$router.push({name:"home"})}}},[n("v-list-tile-action",[n("v-icon",[e._v("home")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("\n            Home\n          ")])],1)],1),n("v-list-tile",{on:{click:function(t){e.$router.push({name:"todo"})}}},[n("v-list-tile-action",[n("v-icon",[e._v("list")])],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v("\n            Todo\n          ")])],1)],1),n("v-subheader",{staticClass:"mt-3 grey--text text--darken-1"},[e._v("TEAMS")]),n("v-list",e._l(e.teams,function(t){return n("v-list-tile",{key:t.name,attrs:{to:"/team/"+t.name,"active-class":"grey darken-2",avatar:""}},[n("v-list-tile-avatar",[n("v-avatar",{attrs:{size:"36"}},[n("span",{staticClass:"white--text headline"},[e._v(e._s(t.icon||""))])])],1),n("v-list-tile-title",{domProps:{textContent:e._s(t.name)}})],1)}),1),n("v-list-tile",{staticClass:"mt-3",on:{click:e.createTeam}},[n("v-list-tile-action",[n("v-icon",{attrs:{color:"grey darken-1"}},[e._v("add_circle_outline")])],1),n("v-list-tile-title",{staticClass:"grey--text text--darken-1"},[e._v("Create Team")])],1),n("v-list-tile",{on:{click:e.openSettings}},[n("v-list-tile-action",[n("v-icon",{attrs:{color:"grey darken-1"}},[e._v("settings")])],1),n("v-list-tile-title",{staticClass:"grey--text text--darken-1"},[e._v("Settings")])],1),n("v-list-tile",{attrs:{href:"https://github.com/chamerling/gitlab-teams/",target:"_blank"}},[n("v-list-tile-action",[n("v-icon",{attrs:{color:"grey darken-1"}},[e._v("info")])],1),n("v-list-tile-title",{staticClass:"grey--text text--darken-1"},[e._v("About")])],1)],1)],1),n("v-toolbar",{attrs:{dark:"",flat:"",fixed:"",app:"","clipped-left":"",dense:"",color:"orange darken-4"}},[n("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),n("v-toolbar-title",[e._v("Gitlab Teams")]),n("v-spacer"),"settings"===e.$route.name?n("v-btn",{attrs:{icon:""},on:{click:e.goBack}},[n("v-icon",{attrs:{small:""}},[e._v("clear")])],1):e._e()],1),n("v-content",[n("v-container",{staticClass:"pa-0"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view")],1)],1)],1)],1)],1)},c=[],l=(n("7f7f"),n("93c6")),m=n.n(l),p={data:function(){return{drawer:null}},methods:{openSettings:function(){this.$router.push({name:"settings"})},createTeam:function(){this.$router.push({name:"create-team"})},goBack:function(){this.$router.go(-1)}},computed:{isConfigured:function(){return this.$store.getters.isConfigured},teams:function(){return m()(this.$store.getters.getTeams,[function(e){return e.name.toLowerCase()}],"asc")}},mounted:function(){this.isConfigured?this.$store.dispatch("launchUserWatchers"):this.openSettings()}},d=p,h=(n("034f"),n("2877")),f=Object(h["a"])(d,u,c,!1,null,null,null);f.options.__file="App.vue";var v=f.exports,g=n("8c4f"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[e.mergeRequests.length?n("merge-requests",{attrs:{"merge-requests":e.mergeRequests}}):e._e()],1)},b=[],k=n("be94"),T=n("2f62"),q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list",{attrs:{"two-line":"",dark:""}},e._l(e.orderedMergeRequests,function(t){return n("div",{key:t.id},[n("merge-request-item",{attrs:{mr:t,pipeline:e.getPipeline(t)}})],1)}))},R=[],O=n("2ef0"),I=n.n(O),j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list-tile",{attrs:{avatar:"",href:e.mr.web_url,target:"_blank"}},[n("v-list-tile-avatar",{on:{click:function(t){t.preventDefault(),e.$router.push({name:"user",params:{name:e.mr.author.username}})}}},[n("user-avatar",{attrs:{user:e.mr.author}})],1),n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(e.mr.title))]),n("v-list-tile-sub-title",[n("div",{attrs:{id:"subtitle"}},[e.pipeline?n("v-tooltip",{attrs:{bottom:""}},[n("v-icon",{attrs:{slot:"activator",color:e.getPipelineColor()},slot:"activator"},[e._v(e._s(e.getPipelineIcon()))]),n("span",[e._v("Pipeline "+e._s(e.pipeline.status)+" - ")]),"running"===e.pipeline.status?n("span",[e._v("Started "+e._s(e._f("moment")(e.pipeline.updated_at,"calendar")))]):n("span",[e._v("Finished "+e._s(e._f("moment")(e.pipeline.finished_at,"calendar")))])],1):e._e(),e._v("\n        "+e._s(e.getProject(e.mr.project_id).name)+"!"+e._s(e.mr.iid)+" - Created "+e._s(e._f("moment")(e.mr.created_at,"calendar"))+" - Updated "+e._s(e._f("moment")(e.mr.updated_at,"calendar"))+"\n      ")],1)])],1),n("v-list-tile-action",[n("div",{attrs:{id:"actions"}},[n("v-badge",{staticClass:"pr-2",attrs:{small:"",overlap:"",left:""}},[n("span",{attrs:{slot:"badge"},slot:"badge"},[e._v(e._s(e.mr.user_notes_count))]),n("v-icon",[e._v("chat")])],1),n("v-badge",{attrs:{overlap:"",left:""}},[n("span",{attrs:{slot:"badge"},slot:"badge"},[e._v(e._s(e.mr.upvotes))]),n("v-icon",[e._v("thumb_up")])],1)],1)])],1)},A=[],y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-menu",{attrs:{"open-on-hover":"","close-on-content-click":!1,"nudge-width":200,"offset-y":"",bottom:""},model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[n("v-avatar",{attrs:{slot:"activator",size:"48"},slot:"activator"},[n("img",{attrs:{src:e.user.avatar_url,alt:e.user.username}})]),n("v-card",[n("v-list",[n("v-list-tile",{attrs:{avatar:""}},[n("v-list-tile-avatar",[n("img",{attrs:{src:e.user.avatar_url}})]),n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(e.user.name))]),n("v-list-tile-sub-title",[e._v("@"+e._s(e.user.username))])],1),n("v-list-tile-action")],1)],1)],1)],1)},U=[],M={name:"user-avatar-popover",props:{user:Object},data:function(){return{menu:!1}},mounted:function(){}},P=M,E=Object(h["a"])(P,y,U,!1,null,null,null);E.options.__file="UserAvatarPopover.vue";var w=E.exports,x={name:"MergeRequestItem",props:{mr:Object,pipeline:Object},computed:Object(k["a"])({},Object(T["b"])({getProject:"getProject"})),methods:{getPipelineColor:function(){var e={pending:"warning",failed:"error",success:"success",running:"primary",canceled:"black"};return e[this.pipeline.status]||"primary"},getPipelineIcon:function(){var e={pending:"pause_circle_outline",failed:"error_outline",success:"check_circle_outline",running:"timelapse",canceled:"highlight_off"};return e[this.pipeline.status]||"help"}},components:{"user-avatar":w}},C=x,S=(n("bd4f"),Object(h["a"])(C,j,A,!1,null,"6fc7293a",null));S.options.__file="MergeRequestItem.vue";var $=S.exports,N={name:"MergeRequests",props:{mergeRequests:Array},methods:{getPipeline:function(e){return this.$store.getters.getPipeline(e.id)}},computed:{orderedMergeRequests:function(){return I.a.orderBy(this.mergeRequests,"created_at","desc")}},components:{MergeRequestItem:$}},D=N,H=Object(h["a"])(D,q,R,!1,null,null,null);H.options.__file="MergeRequests.vue";var L=H.exports,F=(n("b054"),n("6762"),n("2fdb"),n("ac6a"),n("5df3"),n("f400"),n("d4ec")),z=n("bee2"),V=n("99de"),G=n("7e84"),J=n("262e"),B=(n("96cf"),n("1da1")),K=(n("7514"),n("456d"),n("ade3")),W=(n("f751"),n("28a5"),n("2909")),Z=n("53ca");n("6b54"),n("a481");function Y(e){var t=e.toString().replace(/^\/*/,"").replace(/\/*$/,"/");return t.length<=1?"":t}var Q,X,ee={authenticationMethod:{OAUTH:"OAUTH",PERSONAL:"PERSONNAL"},OAUTH_REDIRECT_PATH:"/oauth/redirect"};function te(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return"";if(1===t.length)return Y(t[0].toString());var a="object"===Object(Z["a"])(t[t.length-1]),s=a?t.slice(-1)[0]:{},i=a?t.slice(0,t.length-1):t,r=[Y(i[0])].concat(Object(W["a"])(i.slice(1).map(function(e){return Y(e)}))).join(""),o=a?"?".concat(Object.keys(s).map(function(e){return"".concat(e,"=").concat(s[e])}).join("&")):"";return r+o}var ne={UPDATE_OAUTH_CREDENTIALS:"updateOAuthCredentials",UPDATE_OAUTH_TOKEN:"updateOAuthToken"},ae={canUseOAuth:function(e){return void 0!==e.clientId},accessTokenUri:function(e,t,n){return te(n.gitlabInstance,Object({VUE_APP_GA:"",VUE_APP_POLING_INTERVAL:"5000",VUE_APP_DEFAULT_GITLAB:"https://ci.linagora.com/",VUE_APP_API_TOKEN:"q3k4GUp-FvVeRZ3CHqzF",VUE_APP_OAUTH_CLIENT_ID:"fe29c087950c07ff1e6914a74d5ff44109e19adb3c3feab88b8b2932a4108ef6",VUE_APP_OAUTH_AUTHORIZATION_PATH:"/oauth/authorize",VUE_APP_OAUTH_SCOPES:"api,read_user",NODE_ENV:"production",BASE_URL:"/gitlab-teams/"}).VUE_APP_OAUTH_ACCESS_TOKEN_PATH)},authorizationUri:function(e,t,n){var a={client_id:e.clientId,redirect_uri:te(window.location.origin.toString(),"/gitlab-teams/",ee.OAUTH_REDIRECT_PATH),response_type:"token",state:"state"};return te(n.gitlabInstance,"/oauth/authorize",a)},scopes:function(){return"api,read_user".split(",")},oauthTokenFromLocalStorage:function(){return function(){var e=localStorage.getItem("oauthToken");if(e){var t=JSON.parse(e),n=t.accessToken,a=t.tokenType,s=t.expiresIn;if(n&&a&&s)return{accessToken:n,tokenType:a,expiresIn:Date.parse(s)}}}}},se={clientId:"fe29c087950c07ff1e6914a74d5ff44109e19adb3c3feab88b8b2932a4108ef6",oauthToken:ae.oauthTokenFromLocalStorage()},ie=(Q={},Object(K["a"])(Q,ne.UPDATE_OAUTH_CREDENTIALS,function(e,t){e.clientId=t.clientId||e.clientId}),Object(K["a"])(Q,ne.UPDATE_OAUTH_TOKEN,function(e,t){var n=t.accessToken,a=t.tokenType,s=t.expiresIn;if(!n||!a||!s)throw new Error("Token must feature properties `accessToken`, `tokenType` and `expiresIn`");s=s instanceof Date?s:new Date(s),o["default"].set(e,"oauthToken",Object.assign({},{accessToken:n,tokenType:a,expiresIn:s})),localStorage.setItem("oauthToken",JSON.stringify({accessToken:n,tokenType:a,expiresIn:s.toISOString()}))}),Q),re=(X={},Object(K["a"])(X,ne.UPDATE_OAUTH_CREDENTIALS,function(e,t){var n=e.commit;n(ne.UPDATE_OAUTH_CREDENTIALS,t)}),Object(K["a"])(X,ne.UPDATE_OAUTH_TOKEN,function(e,t){var n=e.commit;n(ne.UPDATE_OAUTH_TOKEN,t)}),X),oe={namespaced:!0,state:se,actions:re,mutations:ie,getters:ae},ue=n("bc3a"),ce=n.n(ue),le=function(){function e(t){Object(F["a"])(this,e),this.store=t;var n=t.state.gitlabInstance;this.persoClient=ce.a.create({baseURL:n}),this.oauthClient=ce.a.create({baseURL:n}),this.oauthClient.interceptors.request.use(this.oauthInterceptor.bind(this)),this.updateClient()}return Object(z["a"])(e,[{key:"updateClient",value:function(){var e=this,t=Object.keys(ee.authenticationMethod);if(this.store.state.authenticationMethod===ee.authenticationMethod.PERSONAL)this.persoClient.defaults.headers.common["Private-Token"]=this.store.state.apiToken,this.client=this.persoClient;else if(this.store.state.authenticationMethod===ee.authenticationMethod.OAUTH)this.client=this.oauthClient;else if(!t.find(function(t){return t===e.store.state.authenticationMethod}))throw new Error("authenticationMethod must match one of ".concat(t))}},{key:"oauthInterceptor",value:function(e){var t=this,n=function(){var n=t.store.state.oauth.oauthToken,a=n.accessToken,s=n.expiresIn;return s.getTime(),(new Date).getTime(),t.oauthClient.defaults.headers.common["Authorization"]="Bearer ".concat(a),e};return this.store.state.oauth.oauthToken?Promise.resolve(n()):this.requestUserAuthorization().then(n)}},{key:"requestUserAuthorization",value:function(){var e=Object(B["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=window.open(this.store.getters["oauth/authorizationUri"],"_blank",void 0,!1),e.abrupt("return",new Promise(function(e,a){t.addEventListener("processComplete",function(){n.store.dispatch("oauth/".concat(ne.UPDATE_OAUTH_TOKEN),n.store.getters["oauth/oauthTokenFromLocalStorage"]()).then(e).catch(function(e){return a("Unable to retreive new token: ".concat(e))})})}));case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"fetchUsers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Promise.all(t.map(function(t){return e.fetchUser(t)}))}},{key:"fetchUser",value:function(e){return this.client.get("/api/v4/users?username=".concat(e)).then(function(e){return e.data[0]})}},{key:"searchUsers",value:function(e){return this.client.get("/api/v4/users?search=".concat(e))}},{key:"fetchMergeRequests",value:function(e){var t=e.state,n=void 0===t?"opened":t,a=e.author_id,s="/api/v4/merge_requests?state=".concat(n);return a&&(s="".concat(s,"&scope=all&author_id=").concat(a)),this.client.get(s)}},{key:"fetchMergeRequest",value:function(e,t){return this.client.get("/api/v4/projects/".concat(e,"/merge_requests/").concat(t))}},{key:"fetchPipelines",value:function(e,t){return this.client.get("/api/v4/projects/".concat(e,"/pipelines?ref=").concat(t))}},{key:"fetchPipeline",value:function(e,t){return this.client.get("/api/v4/projects/".concat(e,"/pipelines/").concat(t))}},{key:"fetchLastPipeline",value:function(e,t){var n=this;return this.fetchPipelines(e,t).then(function(t){return t.data&&t.data.length?n.fetchPipeline(e,t.data[0].id):{}})}},{key:"getCurrentUser",value:function(){return this.client.get("/api/v4/user")}},{key:"fetchProject",value:function(e){return this.client.get("/api/v4/projects/".concat(e)).then(function(e){return e.data})}},{key:"fetchTodos",value:function(){return this.client.get("/api/v4/todos")}},{key:"markTodoAsDone",value:function(e){return this.client.post("/api/v4/todos/".concat(e.id,"/mark_as_done"))}}]),e}(),me=n("808d"),pe=n("d3fb"),de=n("d792"),he=n("1585"),fe=n("a6c5"),ve=n("a2ef"),ge=n("ba10"),_e=n.n(ge),be=function(e){function t(e){var n;return Object(F["a"])(this,t),n=Object(V["a"])(this,Object(G["a"])(t).call(this)),n.store=e,n.subscriptions=new Map,n.userSubscriptions=[],n.pollingInterval=e.state.pollingInterval,n.client=new le(e),n}return Object(J["a"])(t,e),Object(z["a"])(t,[{key:"updateClient",value:function(){this.client.updateClient()}},{key:"requestUserAuthorization",value:function(){return this.client.requestUserAuthorization()}},{key:"watchMergeRequestsForUsers",value:function(e){var t=this,n=e.userIds;n.forEach(function(e){return t.watchMergeRequests({userId:e})})}},{key:"watchMergeRequests",value:function(e){var t=this,n=e.userId,a=Object(me["a"])(0,this.pollingInterval).pipe(Object(de["a"])(function(){return Object(pe["a"])(t.client.fetchMergeRequests({state:"opened",author_id:n}))}),Object(he["a"])("data")),s=a.pipe(Object(fe["a"])(function(e){return e}),Object(ve["a"])(function(e){return e.id})),i=s.subscribe(function(e){var n;t.emit("new-merge-request",e),t.subscriptions.set(e.id,[]);var a=t.watchPipeline(e).subscribe(function(n){n&&t.emit("updated-pipeline",{mergeRequest:e,pipeline:n})}),s=t.watchMergeRequest(e).subscribe(function(n){t.emit("updated-merge-request",n),["merged","closed"].includes(n.state)&&(t.emit("merged-merge-request",n),t.subscriptions.get(e.id).forEach(function(e){return e.unsubscribe()}),t.subscriptions.delete(e.id))});(n=t.subscriptions.get(e.id)).push.apply(n,[a,s,i])})}},{key:"unwatchMergeRequests",value:function(){var e=this;this.subscriptions&&this.subscriptions.forEach(function(t,n){t.forEach(function(e){return e.unsubscribe()}),e.subscriptions.delete(n)})}},{key:"watchMergeRequest",value:function(e){var t=this,n=e.project_id,a=e.iid;return Object(me["a"])(0,this.pollingInterval).pipe(Object(de["a"])(function(){return Object(pe["a"])(t.client.fetchMergeRequest(n,a))}),Object(he["a"])("data"))}},{key:"watchPipeline",value:function(e){var t=this;return Object(me["a"])(0,this.pollingInterval).pipe(Object(de["a"])(function(){return Object(pe["a"])(t.client.fetchLastPipeline(e.source_project_id,e.source_branch))}),Object(he["a"])("data"))}},{key:"watchTodos",value:function(){var e=this,t=Object(me["a"])(0,this.pollingInterval).pipe(Object(de["a"])(function(){return Object(pe["a"])(e.client.fetchTodos())}),Object(he["a"])("data")),n=t.pipe(Object(fe["a"])(function(e){return e}),Object(ve["a"])(function(e){return e.id})),a=n.subscribe(function(t){e.emit("new-todo",t)});this.userSubscriptions.push(a)}},{key:"unwatchUser",value:function(){this.userSubscriptions.forEach(function(e){return e.unsubscribe()}),this.userSubscriptions=[]}}]),t}(_e.a),ke={Api:be,Client:le},Te=null;function qe(e){Te=new ke.Api(e),Te.on("new-merge-request",function(t){e.dispatch("fetchProject",t.project_id).then(function(){e.dispatch("addMergeRequest",t)})}),Te.on("updated-pipeline",function(t){var n=t.mergeRequest,a=t.pipeline;e.dispatch("updatePipeline",{mergeRequest:n,pipeline:a})}),Te.on("updated-merge-request",function(t){e.dispatch("updateMergeRequest",t)}),Te.on("merged-merge-request",function(t){e.dispatch("removeMergeRequest",t)}),Te.on("new-todo",function(t){e.dispatch("addTodo",t)})}function Re(){return Te}var Oe={get:Re,init:qe},Ie={fetchUsers:function(e){var t=e.state,n=e.commit;return Oe.get().client.fetchUsers(t.team.usernames).then(function(e){return n("setUsers",e)})},fetchUser:function(e,t){var n=e.commit;return Oe.get().client.fetchUser(t).then(function(e){return n("setCurrentUser",e)})},fetchProject:function(e,t){var n=e.commit,a=e.state;return a.projects[t]?Promise.resolve(a.projects[t]):Oe.get().client.fetchProject(t).then(function(e){return n("addProject",e),e})},cleanMergeRequests:function(e){var t=e.commit,n=Oe.get();n.unwatchMergeRequests(),t("setMergeRequests",{}),t("setPipelines",{})},addMergeRequest:function(e,t){var n=e.commit;n("addMergeRequest",t)},removeMergeRequest:function(e,t){var n=e.commit;n("removeMergeRequest",t)},updateMergeRequest:function(e,t){var n=e.commit;n("updateMergeRequest",t)},updatePipeline:function(e,t){var n=e.commit,a=t.mergeRequest,s=t.pipeline;n("updatePipeline",{mergeRequest:a,pipeline:s})},updateSettings:function(e,t){var n=e.commit,a=e.dispatch;n("updateSettings",t),n("resetTeams"),n("setMergeRequests",{}),n("setPipelines",{}),n("setProjects",{}),a("launchWatchers")},loadCurrentUser:function(e){var t=e.dispatch,n=Oe.get();t("cleanMergeRequests"),n.watchMergeRequests({})},loadUser:function(e,t){var n=e.dispatch,a=e.state,s=Oe.get();n("cleanMergeRequests"),n("fetchUser",t).then(function(){s.watchMergeRequestsForUsers({userIds:[a.currentUser.id]})})},loadTeam:function(e,t){var n=e.commit,a=e.dispatch;a("cleanMergeRequests"),n("setCurrentTeam",t),a("launchWatchers")},createTeam:function(e,t){var n=e.commit;n("addTeam",t)},launchWatchers:function(e){var t=e.dispatch,n=e.state,a=Oe.get();t("fetchUsers").then(function(){a.watchMergeRequestsForUsers({userIds:n.team.users.map(function(e){return e.id})})})}},je=(n("8615"),n("3ff1")),Ae=n.n(je),ye={getTeams:function(e){return e.teams},getMergeRequest:function(e,t){var n=e.mergeRequests;return n[t]},getMergeRequestsForUser:function(e){var t=e.mergeRequests;return function(e){return Object.values(t).filter(function(t){return t.author.username===e})}},getPipeline:function(e){var t=e.pipelines;return function(e){return t[e]}},getMergeRequests:function(e){var t=e.mergeRequests;return Ae()(t)},getProject:function(e){var t=e.projects;return function(e){return t[e]}},isConfigured:function(e){return!!e.apiToken}},Ue=n("2769"),Me=n.n(Ue),Pe={addProject:function(e,t){var n=e.projects;o["default"].set(n,t.id,t)},setProjects:function(e,t){e.projects=t},addMergeRequest:function(e,t){var n=e.mergeRequests;o["default"].set(n,t.id,t)},removeMergeRequest:function(e,t){var n=e.mergeRequests;o["default"].delete(n,t.id)},setMergeRequests:function(e,t){e.mergeRequests=t},resetMergeRequests:function(e){e.mergeRequests={}},updateMergeRequest:function(e,t){var n=e.mergeRequests;o["default"].set(n,t.id,t)},setCurrentTeam:function(e,t){e.team=Me()(e.teams,{name:t})},addTeam:function(e,t){e.teams.push(t),localStorage.setItem("teams",JSON.stringify(e.teams))},resetTeams:function(e){localStorage.setItem("teams",JSON.stringify([])),e.teams={},e.team={}},updatePipeline:function(e,t){var n=e.pipelines,a=t.mergeRequest,s=t.pipeline;o["default"].set(n,a.id,s)},removePipeline:function(e,t){var n=e.pipelines,a=t.mergeRequest;o["default"].delete(n,a.id)},setPipelines:function(e,t){e.pipelines=t},updateSettings:function(e,t){e.gitlabInstance=t.gitlabInstance,e.apiToken=t.apiToken,localStorage.setItem("gitlabInstance",e.gitlabInstance),localStorage.setItem("apiToken",e.apiToken),Oe.get().unwatchMergeRequests(),Oe.init(this)},setUsers:function(e,t){e.team.users=t},setCurrentUser:function(e,t){e.currentUser=t},setAuthenticationMethod:function(e,t){e.authenticationMethod=t}},Ee={gitlabInstance:"https://ci.linagora.com/",apiToken:"q3k4GUp-FvVeRZ3CHqzF",mergeRequests:{},pipelines:{},pollingInterval:"5000",teams:JSON.parse(localStorage.getItem("teams")||"[]"),team:{},projects:{},currentUser:null,authenticationMethod:ee.authenticationMethod.PERSONAL},we=[];o["default"].use(T["a"]);var xe=new T["a"].Store({plugins:we,state:Ee,getters:ye,mutations:Pe,actions:Ie,modules:{oauth:oe}}),Ce={name:"home",components:{MergeRequests:L},computed:Object(k["a"])({},Object(T["b"])({mergeRequests:"getMergeRequests"})),beforeRouteEnter:function(e,t,n){xe.dispatch("loadCurrentUser"),n()},beforeRouteUpdate:function(e,t,n){xe.dispatch("loadCurrentUser"),n()}},Se=Ce,$e=Object(h["a"])(Se,_,b,!1,null,null,null);$e.options.__file="Home.vue";var Ne=$e.exports,De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-tabs",{attrs:{grow:!0},model:{value:e.tabs,callback:function(t){e.tabs=t},expression:"tabs"}},[n("v-tabs-slider"),e._l(e.authenticationMethods,function(t,a){return n("v-tab",{key:a},[e._v(" "+e._s(t.text)+" ")])})],2),n("v-tabs-items",{model:{value:e.tabs,callback:function(t){e.tabs=t},expression:"tabs"}},e._l(e.authenticationMethods,function(t,a){return n("v-tab-item",{key:a},[n(t.component,{tag:"component",attrs:{"on-save":e.save}})],1)}),1)],1)},He=[],Le=(n("20d6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pa-3"},[n("v-form",[n("v-text-field",{attrs:{label:"API Token",required:""},model:{value:e.apiToken,callback:function(t){e.apiToken=t},expression:"apiToken"}}),n("v-text-field",{attrs:{label:"Gitlab URL",required:""},model:{value:e.gitlabInstance,callback:function(t){e.gitlabInstance=t},expression:"gitlabInstance"}}),n("v-btn",{on:{click:e.submit}},[e._v("Submit")])],1)],1)}),Fe=[],ze={name:"personal-token-settings",props:{onSave:{type:Function,required:!0}},data:function(){return{apiToken:null,gitlabInstance:null}},mounted:function(){this.apiToken=this.$store.state.apiToken,this.gitlabInstance=this.$store.state.gitlabInstance},methods:{submit:function(){var e=Object(B["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("updateSettings",{apiToken:this.apiToken,gitlabInstance:this.gitlabInstance});case 2:this.onSave(),this.$router.push("/");case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},components:{}},Ve=ze,Ge=Object(h["a"])(Ve,Le,Fe,!1,null,null,null);Ge.options.__file="PersonalTokenSettings.vue";var Je=Ge.exports,Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pa-3"},[n("v-form",[n("v-text-field",{attrs:{label:"Client ID",required:""},model:{value:e.clientId,callback:function(t){e.clientId=t},expression:"clientId"}}),n("v-text-field",{attrs:{label:"Gitlab URL",required:""},model:{value:e.gitlabInstance,callback:function(t){e.gitlabInstance=t},expression:"gitlabInstance"}}),n("v-btn",{on:{click:e.submit}},[e._v("Submit")])],1)],1)},Ke=[],We={name:"oauth-token-settings",props:{onSave:{type:Function,required:!0}},data:function(){return{clientId:this.$store.state.oauth.clientId,gitlabInstance:this.$store.state.gitlabInstance}},methods:{submit:function(){var e=Object(B["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.$store.dispatch("oauth/".concat(ne.UPDATE_OAUTH_CREDENTIALS),{clientId:this.clientId}),this.$store.dispatch("updateSettings",{apiToken:this.$store.state.apiToken,gitlabInstance:this.gitlabInstance})]);case 2:return this.onSave(),e.next=5,Oe.get().requestUserAuthorization();case 5:this.$router.push("/");case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},components:{}},Ze=We,Ye=Object(h["a"])(Ze,Be,Ke,!1,null,null,null);Ye.options.__file="OAuthTokenSettings.vue";var Qe=Ye.exports,Xe={name:"settings",components:{"oauth-token-settings":Qe,"personal-token-settings":Je},data:function(){return{tabs:void 0}},computed:Object(k["a"])({},Object(T["c"])(["authenticationMethod"]),{authenticationMethods:function(){return[{text:"Oauth",component:Qe,authenticationMethod:ee.authenticationMethod.OAUTH},{text:"Personnal token",component:Je,authenticationMethod:ee.authenticationMethod.PERSONAL}]}}),methods:{save:function(){this.$store.commit("setAuthenticationMethod",this.authenticationMethods[this.tabs].authenticationMethod),Oe.get().updateClient()}},beforeMount:function(){var e=this,t=this.authenticationMethods.findIndex(function(t){return t.authenticationMethod===e.authenticationMethod});this.tabs=t>=0?t:0}},et=Xe,tt=Object(h["a"])(et,De,He,!1,null,null,null);tt.options.__file="Settings.vue";var nt=tt.exports,at=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("v-layout",{attrs:{"align-center":"","justify-end":"",row:"","fill-height":"","ma-2":""}},e._l(e.team.users,function(t){return n("div",{key:t.id,staticClass:"ma-1",attrs:{id:"user"},on:{click:function(n){e.$router.push({name:"user",params:{name:t.username}})}}},[n("v-badge",{attrs:{overlap:""}},[n("span",{attrs:{slot:"badge"},slot:"badge"},[e._v(e._s(e.userMergeRequests(t.username).length))]),n("user-avatar",{attrs:{user:t}})],1)],1)})),e.mergeRequests.length?n("merge-requests",{attrs:{"merge-requests":e.mergeRequests}}):e._e()],1)},st=[],it={name:"team",components:{MergeRequests:L,"user-avatar":w},computed:Object(k["a"])({},Object(T["c"])(["team"]),Object(T["b"])({mergeRequests:"getMergeRequests",userMergeRequests:"getMergeRequestsForUser"})),beforeRouteEnter:function(e,t,n){xe.dispatch("loadTeam",e.params.name),n()},beforeRouteUpdate:function(e,t,n){xe.dispatch("loadTeam",e.params.name),n()}},rt=it,ot=(n("bbc3"),Object(h["a"])(rt,at,st,!1,null,"e8ed1374",null));ot.options.__file="Team.vue";var ut=ot.exports,ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list",{attrs:{"two-line":"",dark:""}},[e._l(e.todos,function(t,a){return[n("todo",{key:t.id,attrs:{item:t}}),a+1<e.todos.length?n("v-divider",{key:a}):e._e()]})],2)},lt=[],mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list-tile",{attrs:{avatar:"",href:e.item.target_url,target:"_blank"}},[n("v-list-tile-avatar",{on:{click:function(t){t.preventDefault(),e.$router.push({name:"user",params:{name:e.item.author.username}})}}},[n("user-avatar",{attrs:{user:e.item.author}})],1),n("v-list-tile-content",[n("v-list-tile-title",["assigned"===e.item.action_name?["Issue"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" assigned you the issue "+e._s(e.getIssueAsText())+"\n        ")]:e._e(),"MergeRequest"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" assigned you the merge request "+e._s(e.getMergeRequestAsText())+"\n        ")]:e._e()]:e._e(),"mentioned"===e.item.action_name?["Issue"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" mentioned you in the issue "+e._s(e.getIssueAsText())+"\n        ")]:e._e(),"MergeRequest"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" mentioned you the merge request "+e._s(e.getMergeRequestAsText())+"\n        ")]:e._e()]:e._e(),"build_failed"===e.item.action_name?[e._v("\n        Build failed\n      ")]:e._e(),"marked"===e.item.action_name?[e._v("\n        ?\n      ")]:e._e(),"approval_required"===e.item.action_name?["MergeRequest"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" require your approval in merge request "+e._s(e.getMergeRequestAsText())+"\n        ")]:[e._v("\n          ?\n        ")]]:e._e(),"unmergeable"===e.item.action_name?["MergeRequest"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" marked the merge request as unmergeable in "+e._s(e.getMergeRequestAsText())+"\n        ")]:e._e()]:e._e(),"directly_addressed"===e.item.action_name?["Issue"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" directly addressed you in the issue "+e._s(e.getIssueAsText())+"\n        ")]:e._e(),"MergeRequest"===e.item.target_type?[e._v("\n          "+e._s(e.item.author.name||e.item.author.username)+" directly addressed you in the merge request "+e._s(e.getMergeRequestAsText())+"\n        ")]:e._e()]:e._e()],2),n("v-list-tile-sub-title",[n("div",{staticClass:"ellipsis"},[e._v("\n        "+e._s(e._f("moment")(e.item.created_at,"calendar"))+"\n      ")]),n("v-list-tile-sub-title",{staticClass:"ellipsis"},[e._v(e._s(e.item.body))])],1)],1),n("v-list-tile-action",[n("div",{attrs:{id:"actions"}},[n("v-btn",{attrs:{outline:"",fab:"",small:"",dark:""},on:{click:function(t){t.preventDefault(),e.markAsRead()}}},[n("v-icon",[e._v("check")])],1)],1)])],1)},pt=[],dt={name:"Todo",props:{item:Object},computed:{},methods:{markAsRead:function(){this.$store.dispatch("markTodoAsDone",this.item)},getMergeRequestAsText:function(){return"".concat(this.item.project.path,"!").concat(this.item.target.iid)},getIssueAsText:function(){return"".concat(this.item.project.path,"#").concat(this.item.target.iid)}},components:{"user-avatar":w}},ht=dt,ft=(n("3778"),Object(h["a"])(ht,mt,pt,!1,null,"0b280d64",null));ft.options.__file="Todo.vue";var vt=ft.exports,gt={name:"todos",components:{Todo:vt},computed:Object(k["a"])({},Object(T["b"])({todos:"getTodos"}))},_t=gt,bt=Object(h["a"])(_t,ct,lt,!1,null,null,null);bt.options.__file="Todos.vue";var kt=bt.exports,Tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[e.mergeRequests.length?n("merge-requests",{attrs:{"merge-requests":e.mergeRequests}}):e._e()],1)},qt=[],Rt={name:"user",components:{MergeRequests:L},computed:Object(k["a"])({},Object(T["b"])({mergeRequests:"getMergeRequests"})),beforeRouteEnter:function(e,t,n){xe.dispatch("loadUser",e.params.name),n()},beforeRouteUpdate:function(e,t,n){xe.dispatch("loadUser",e.params.name),n()}},Ot=Rt,It=Object(h["a"])(Ot,Tt,qt,!1,null,null,null);It.options.__file="User.vue";var jt=It.exports,At=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},yt=[],Ut={name:"NewOAuthToken",props:{accessToken:{type:String,required:!0},state:String,tokenType:{type:String,required:!0},expiresIn:String},beforeMount:function(){if(!this.expiresIn){var e=new Date;e.setFullYear(e.getFullYear()+1),this.expiresIn=e.toISOString()}},mounted:function(){localStorage.setItem("oauthToken",JSON.stringify({accessToken:this.accessToken,tokenType:this.tokenType,expiresIn:this.expiresIn})),window.dispatchEvent(new Event("processComplete")),window.close()}},Mt=Ut,Pt=Object(h["a"])(Mt,At,yt,!1,null,null,null);Pt.options.__file="NewOAuthToken.vue";var Et=Pt.exports,wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pa-3"},[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{attrs:{label:"Name",rules:[function(e){return!!e||"Name is required"}],required:"",autofocus:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("v-text-field",{attrs:{label:"Avatar   丑",disabled:"",required:""},model:{value:e.icon,callback:function(t){e.icon=t},expression:"icon"}}),n("v-autocomplete",{attrs:{items:e.items,loading:e.isLoading,"search-input":e.search,chips:"","item-text":"name","item-value":"name",label:"Members",multiple:"","cache-items":"","return-object":""},on:{"update:searchInput":function(t){e.search=t}},scopedSlots:e._u([{key:"selection",fn:function(t){return[n("v-chip",{attrs:{selected:t.selected,close:""},on:{input:function(n){e.remove(t.item,t)}}},[n("v-avatar",[n("img",{attrs:{src:t.item.avatar_url}})]),e._v("\n        "+e._s(t.item.name)+"\n        ")],1)]}},{key:"item",fn:function(t){return[n("v-list-tile-avatar",[n("v-avatar",[n("img",{attrs:{src:t.item.avatar_url}})])],1),n("v-list-tile-content",[n("v-list-tile-title",{domProps:{textContent:e._s(t.item.name)}})],1)]}}]),model:{value:e.members,callback:function(t){e.members=t},expression:"members"}},[n("template",{slot:"no-data"},[n("v-list-tile",[n("v-list-tile-title",[e._v("\n            Search Gitlab User...\n          ")])],1)],1)],2),n("v-btn",{attrs:{disabled:!e.valid},on:{click:e.create}},[e._v("Create")]),n("v-btn",{on:{click:e.clear}},[e._v("Clear")])],1)],1)},xt=[],Ct={data:function(){return{valid:!0,name:null,icon:"",members:[],isLoading:!1,items:[],search:null}},methods:{create:function(){if(this.$refs.form.validate()){var e={name:this.name,icon:this.icon,usernames:this.members.map(function(e){return e.username})};this.$store.dispatch("createTeam",e),this.$router.push({name:"team",params:{name:e.name}})}},clear:function(){this.$refs.form.reset()},remove:function(e,t){I.a.remove(this.members,function(t){return t.id===e.id})}},watch:{search:function(e){var t=this;e&&null!==e&&(this.isLoading=!0,Oe.get().client.searchUsers(e).then(function(e){return t.items=e.data}).catch(console.log).finally(function(){return t.isLoading=!1}))}}},St=Ct,$t=Object(h["a"])(St,wt,xt,!1,null,null,null);$t.options.__file="CreateTeam.vue";var Nt=$t.exports;o["default"].use(g["a"]);var Dt=new g["a"]({base:"/gitlab-teams/",mode:"history",routes:[{path:"/",name:"home",component:Ne},{path:"/todo",name:"todo",component:kt},{path:ee.OAUTH_REDIRECT_PATH,component:Et,beforeEnter:function(e,t,n){e.hash.length>=1&&n("".concat(ee.OAUTH_REDIRECT_PATH,"?").concat(e.hash.slice(1))),n()},props:function(e){return{accessToken:e.query.access_token,state:e.query.state,tokenType:e.query.token_type,expiresIn:e.query.expires_in}}},{path:"/team/:name",name:"team",component:ut},{path:"/user/:name",name:"user",component:jt},{path:"/settings",name:"settings",component:nt},{path:"/settings/team/create",name:"create-team",component:Nt},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]});o["default"].config.productionTip=!1,o["default"].use(r.a),o["default"].use(s.a),Oe.init(xe);var Ht=new o["default"]({router:Dt,store:xe,render:function(e){return e(v)}}).$mount("#app");window.Application=Ht},"63c8":function(e,t,n){},"64a9":function(e,t,n){},ba79:function(e,t,n){},bbc3:function(e,t,n){"use strict";var a=n("1f6e"),s=n.n(a);s.a},bd4f:function(e,t,n){"use strict";var a=n("63c8"),s=n.n(a);s.a}}]);
//# sourceMappingURL=chunk-common.bb92dad3.js.map